<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2D Web Game</title>

<style>
body{margin:0;font-family:Arial;background:#0f172a;color:white;overflow:hidden}

/* LOADING */
#loadingScreen{
position:fixed;inset:0;background:#020617;
display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999;
}
#progressBox{width:60%;height:28px;border:2px solid white;margin-top:20px}
#progressBar{height:100%;width:0;background:lime}
#percentText{margin-top:10px;font-size:20px}

/* MENU */
#mainMenu{
position:fixed;inset:0;display:none;align-items:center;justify-content:center;
flex-direction:column;gap:15px;background:linear-gradient(#020617,#0f172a);
}
.menuBtn{padding:12px 40px;background:#1e293b;border:none;color:white;font-size:18px;border-radius:8px}

/* SIDEBAR */
#sidebar{
position:fixed;left:-320px;top:0;width:320px;height:100%;
background:#111827;transition:.3s;padding-top:60px;z-index:2000;overflow:auto;
}
.sideItem{padding:14px 20px;border-bottom:1px solid #374151}
.sideItem:hover{background:#1f2937}
#toggleBtn{
position:fixed;top:10px;left:10px;font-size:26px;
background:#1e293b;padding:6px 12px;border-radius:8px;z-index:2100;display:none;
}

/* HUD */
#hud{position:fixed;top:10px;left:60px;display:none}
#fps{position:fixed;top:10px;right:20px}

/* CANVAS */
#gameCanvas{display:none;background:#0b1220}

/* PAUSE */
#pauseMenu{
position:fixed;inset:0;background:rgba(0,0,0,.7);
display:none;align-items:center;justify-content:center;flex-direction:column;gap:15px;z-index:3000;
}

/* MOBILE CONTROLS */
#mobileControls{
position:fixed;
bottom:20px;
left:20px;
display:none;
z-index:4000;
}
.ctrl{
width:70px;height:70px;border-radius:50%;
background:rgba(255,255,255,0.15);
display:flex;align-items:center;justify-content:center;
font-size:28px;margin:5px;
user-select:none;
}
.row{display:flex;justify-content:center}
</style>
</head>
<body>

<!-- LOADING -->
<div id="loadingScreen">
<h1>Initializing Game Engine...</h1>
<div id="progressBox"><div id="progressBar"></div></div>
<div id="percentText">0%</div>
</div>

<!-- MENU -->
<div id="mainMenu">
<h1>WEB RPG DEMO</h1>

<h3>Pilih Level:</h3>
<button class="menuBtn" onclick="setDifficulty(0)">Easy</button>
<button class="menuBtn" onclick="setDifficulty(1)">Normal</button>
<button class="menuBtn" onclick="setDifficulty(2)">Hard</button>
<button class="menuBtn" onclick="setDifficulty(3)">Extreme</button>

<br>
<button class="menuBtn" onclick="startGame()">PLAY</button>
</div>

<!-- SIDEBAR -->
<div id="toggleBtn">☰</div>
<div id="sidebar">
<div class="sideItem">Inventory</div>
<div class="sideItem">Map</div>
<div class="sideItem">Skills</div>
<div class="sideItem">Quests</div>
<div class="sideItem">Character Stats</div>
<div class="sideItem" onclick="toggleMusic()">Audio Mute</div>
<div class="sideItem" onclick="toggleFullscreen()">Fullscreen</div>
<div class="sideItem" onclick="backToMenu()">Back to Menu</div>
</div>

<!-- HUD -->
<div id="hud">
<div>Health: <span id="hp">100</span></div>
<div>Difficulty: <span id="diff">Easy</span></div>
<div>Pos: <span id="pos">0,0</span></div>
</div>
<div id="fps">FPS: 0</div>

<!-- PAUSE -->
<div id="pauseMenu">
<h1>PAUSED</h1>
<button class="menuBtn" onclick="resume()">Resume</button>
<button class="menuBtn" onclick="backToMenu()">Main Menu</button>
</div>

<!-- MOBILE CONTROL BUTTONS -->
<div id="mobileControls">
<div class="row"><div class="ctrl" ontouchstart="press('w')" ontouchend="release('w')">▲</div></div>
<div class="row">
<div class="ctrl" ontouchstart="press('a')" ontouchend="release('a')">◀</div>
<div class="ctrl" ontouchstart="press('s')" ontouchend="release('s')">▼</div>
<div class="ctrl" ontouchstart="press('d')" ontouchend="release('d')">▶</div>
</div>
</div>

<canvas id="gameCanvas"></canvas>

<div id="ytPlayer" style="position:absolute; left:-9999px; top:-9999px;"></div>
<script src="https://www.youtube.com/iframe_api"></script>

<script>
/* LOADING */
let p=0;
let bar=document.getElementById("progressBar");
let txt=document.getElementById("percentText");
let load=setInterval(()=>{
p++;
bar.style.width=p+"%";
txt.innerText=p+"%";
if(p>=100){
clearInterval(load);
loadingScreen.style.display="none";
mainMenu.style.display="flex";
}
},600);

/* DIFFICULTY */
let difficulty=0;
const diffNames=["Easy","Normal","Hard","Extreme"];
function setDifficulty(d){
difficulty=d;
document.getElementById("diff").innerText=diffNames[d];
}

/* SIDEBAR */
let sidebar=document.getElementById("sidebar");
let toggle=document.getElementById("toggleBtn");
let open=false;
toggle.onclick=()=>{open=!open;sidebar.style.left=open?"0":"-320px";};

/* GAME */
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
let running=false,paused=false;

function startGame(){
mainMenu.style.display="none";
canvas.style.display="block";
hud.style.display="block";
toggle.style.display="block";
mobileControls.style.display="block";
resize();
running=true;
if(ytPlayer)ytPlayer.playVideo();
requestAnimationFrame(loop);
}

/* PLAYER */
let player={x:300,y:300,size:30,speed:3,health:100};

/* difficulty effect */
function applyDifficulty(){
if(difficulty==0){player.speed=3;player.health=150;}
if(difficulty==1){player.speed=3;player.health=100;}
if(difficulty==2){player.speed=3.5;player.health=80;}
if(difficulty==3){player.speed=4;player.health=60;}
document.getElementById("hp").innerText=player.health;
}
applyDifficulty();

/* WALLS */
let walls=[
{x:200,y:200,w:300,h:40},
{x:600,y:100,w:40,h:300},
{x:100,y:500,w:400,h:40}
];

/* CONTROLS */
let keys={};
document.addEventListener("keydown",e=>{keys[e.key.toLowerCase()]=true;if(e.key==="Escape")pause();});
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

function press(k){keys[k]=true;}
function release(k){keys[k]=false;}

function move(){
let nx=player.x,ny=player.y;
if(keys["w"])ny-=player.speed;
if(keys["s"])ny+=player.speed;
if(keys["a"])nx-=player.speed;
if(keys["d"])nx+=player.speed;

let hit=false;
for(let w of walls){
if(nx<w.x+w.w&&nx+player.size>w.x&&ny<w.y+w.h&&ny+player.size>w.y)hit=true;
}
if(!hit){player.x=nx;player.y=ny;}
}

/* LOOP */
let last=0;
function loop(t){
if(!running)return;
let fps=Math.round(1000/(t-last));last=t;
document.getElementById("fps").innerText="FPS: "+fps;
if(!paused)update();
draw();
requestAnimationFrame(loop);
}

function update(){
move();
document.getElementById("pos").innerText=Math.floor(player.x)+","+Math.floor(player.y);
}

function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);
let camX=player.x-canvas.width/2;
let camY=player.y-canvas.height/2;
ctx.save();ctx.translate(-camX,-camY);

ctx.fillStyle="gray";
for(let w of walls)ctx.fillRect(w.x,w.y,w.w,w.h);

ctx.fillStyle="blue";
ctx.fillRect(player.x,player.y,player.size,player.size);

ctx.restore();
}

/* PAUSE */
function pause(){paused=!paused;pauseMenu.style.display=paused?"flex":"none";}
function resume(){pause();}

/* UTIL */
function resize(){canvas.width=innerWidth;canvas.height=innerHeight;}
onresize=resize;

function backToMenu(){
running=false;
canvas.style.display="none";
hud.style.display="none";
toggle.style.display="none";
mobileControls.style.display="none";
mainMenu.style.display="flex";
}

/* YOUTUBE AUDIO */
let ytPlayer,muted=false;
function onYouTubeIframeAPIReady(){
ytPlayer=new YT.Player("ytPlayer",{height:"0",width:"0",videoId:"RA6Pq2o24Tk",
playerVars:{controls:0,loop:1,playlist:"RA6Pq2o24Tk"},
events:{onReady:e=>e.target.setVolume(40)}});
}
function toggleMusic(){if(!ytPlayer)return;muted=!muted;muted?ytPlayer.mute():ytPlayer.unMute();}

/* FULLSCREEN */
function toggleFullscreen(){
if(!document.fullscreenElement)document.documentElement.requestFullscreen();
else document.exitFullscreen();
}
</script>
</body>
</html>